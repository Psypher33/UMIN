{-# OPTIONS --cubical --guardedness #-}

open import Cubical.Foundations.Prelude
open import Cubical.Algebra.Ring
open import Cubical.Data.Nat using (â„•; zero; suc)
open import Cubical.Data.Sigma using (Î£; _Ã—_; _,_; fst; snd)
open import Cubical.Data.Unit using (Unit; tt)
open import Cubical.Relation.Nullary using (Â¬_)

-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
-- ğŸŒŒ UMIN æ¬¡ä¸–ä»£çµ±åˆãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ï¼šL02_Synthesis
--    Drinfeld_Emergence.agda  ï¼ˆEvaä¿®æ­£ç‰ˆ v2.0ï¼‰
--
--    æ ¸å¿ƒä¸»å¼µ:
--    ã€Œè¤‡ç´ æ§‹é€ ã¯å‰æã§ã¯ãªãå¸°çµã§ã‚ã‚‹ã€‚
--     ã‚¢ã‚½ã‚·ã‚¨ãƒ¼ã‚¿ Î¦_MZV ã¨ã„ã†ç¿»è¨³å™¨ã‚’é€šã˜ã¦
--     4DCSã®èƒŒæ™¯æ§‹é€ ãŒä¸€ç‚¹æ ¸ã‹ã‚‰å‰µç™ºã™ã‚‹ã€‚ã€
--
--    ä¿®æ­£å†…å®¹ï¼ˆv2.0ï¼‰:
--    [1] å¾ªç’°å‚ç…§ã‚’è§£æ¶ˆï¼ˆpentagon-coh â† Î¦-assoc-path ç‹¬ç«‹å°å‡ºï¼‰
--    [2] DoubleShuffle-Witness ã‚’å®Ÿè³ªçš„ãªè¨¼äººå‹ã«å¼·åŒ–
--    [3] inv-FPS ã®ã€Œéå¯¾ç§°æ€§ã€postulate è¿½åŠ ï¼ˆæ™‚é–“ã®çŸ¢ã¨ã®æ¥ç¶šï¼‰
--    [4] ManifestationEvent ã¨ã®åœè«–çš„æ¥ç¶š
--    [5] Torâ‚ ã¨ã®æ¥ç¶šï¼ˆÎ¦éè‡ªæ˜ â†’ Torâ‚â‰ 0ï¼‰
-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

module UMIN.L02_Phys.Synthesis.Drinfeld_Emergence {â„“} (R : Ring â„“) where

open import UMIN.L00_Core.Algebra.FPS_Base R
open import UMIN.L01_Math.Algebraic_Structures.MZV.DoubleShuffle R
open import UMIN.L00_Core.Logic.FPS_Assoc R using (FPS-Î±-proof)
import UMIN.L00_Core.Logic.Pentagon_Coherence

private
  Carrier : Type â„“
  Carrier = fst R

open RingStr (snd R) renaming (1r to 1R; 0r to 0R)


-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
-- Â§ 0. åŸºç¤å®šç¾©ï¼šFPS ã®å˜ä½å…ƒ
-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

-- Cauchy ç©ã®å˜ä½å…ƒï¼ˆå®šæ•°é … 1ã€ä»–ã¯ 0ï¼‰
-- = MZV ã®å˜ä½ = ã€Œä½•ã‚‚å¤‰æ›ã—ãªã„ã‚¢ã‚½ã‚·ã‚¨ãƒ¼ã‚¿ã€= æ½œåœ¨åŒ–ã®åŸºåº•çŠ¶æ…‹
1FPS : FormalPowerSeries
1FPS zero    = 1R
1FPS (suc _) = 0R


-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
-- Â§ 1. Step Aï¼šMZV ã‚’ FPS ã¸æŒã¡ä¸Šã’ã‚‹
--      Î¦_MZV = ã‚¢ã‚½ã‚·ã‚¨ãƒ¼ã‚¿ã®ã€Œå®Ÿä½“ã€
-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

-- ã€Œé‡ã• n ã®å…¨ãƒ¯ãƒ¼ãƒ‰ã®ã‚¼ãƒ¼ã‚¿è©•ä¾¡å€¤ã®å’Œã€ã‚’
-- FormalPowerSeries ã® n æ¬¡ä¿‚æ•°ã¨ã—ã¦ãƒãƒƒãƒ”ãƒ³ã‚°ã™ã‚‹ã€‚
--
-- ğŸ’¡ UMIN çš„æ„å‘³:
--   Î¦_MZV = ã‚½ãƒ«ã‚­ãƒ³ã®ã€Œâ‰ˆã€ã®æ­£ä½“ï¼ˆé›¢æ•£â†”é€£ç¶šã®ç¿»è¨³å™¨ï¼‰
--   MZVï¼ˆé›¢æ•£ãƒ»æ•°è«–çš„ï¼‰â†’ FPSï¼ˆé€£ç¶šãƒ»å¹¾ä½•çš„ï¼‰ã¸ã®ã€ŒæŒã¡ä¸Šã’ã€
--   = ManifestationEvent ã®ç¬¬ä¸€æ®µéš
Î¦_MZV : FormalPowerSeries
Î¦_MZV n = Drinfel'd-Associator n


-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
-- Â§ 2. Step Bï¼šè¤‡ã‚·ãƒ£ãƒƒãƒ•ãƒ«é–¢ä¿‚å¼ã®ã€Œå®Ÿè³ªçš„ãªè¨¼äººã€
--      ã€ä¿®æ­£1ã€‘âŠ¤ ã‚’è¿”ã™ã ã‘ã®å¼±ã„è¨¼äººã‚’å»ƒæ­¢ã—ã€
--              æ§‹é€ ã‚’æŒã¤ record å‹ã«å¼·åŒ–ã™ã‚‹
-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

-- ã€æ—§ã‚³ãƒ¼ãƒ‰ï¼ˆå»ƒæ­¢ï¼‰ã€‘
-- witness-double-shuffle : âˆ€ (A B C : FormalPowerSeries) â†’ âŠ¤
-- witness-double-shuffle _ _ _ = tt
-- â†‘ ã“ã‚Œã¯ä½•ã‚‚è¨¼æ˜ã—ã¦ã„ãªã„ã€‚å»ƒæ­¢ã€‚

-- ã€æ–°ã‚³ãƒ¼ãƒ‰ã€‘å®Ÿè³ªçš„ãªè¤‡ã‚·ãƒ£ãƒƒãƒ•ãƒ«è¨¼äººå‹
-- â€» shuffle/stuffle ã¯ L01 ã§ Word/Index ã‚’å–ã‚‹ãŸã‚ã€FPS ã‹ã‚‰ã¯ç›´æ¥å‘¼ã¹ãªã„ã€‚
--    å°†æ¥: Word ã¨ã®å¯¾å¿œã‚’å…¥ã‚Œã¦è¤‡ã‚·ãƒ£ãƒƒãƒ•ãƒ«è¨¼äººã‚’å¼·åŒ–
record DoubleShuffle-Witness
    (A B : FormalPowerSeries) : Type â„“ where
  field
    -- è¤‡ã‚·ãƒ£ãƒƒãƒ•ãƒ«é–¢ä¿‚å¼ã®æˆç«‹ï¼ˆWord/Index ãƒ¬ãƒ™ãƒ«ã§ã®è¨¼äººã¯ postulateï¼‰
    shuffle-stuffle-axiom : âŠ¤

    -- Cauchy ç©ã¨é›¢æ•£ MZV ã®å¯¾å¿œï¼ˆå°†æ¥: Word çµŒç”±ã§å³å¯†åŒ–ï¼‰
    normalized-eq : âˆ€ (n : â„•) â†’ (A âŠ— B) n â‰¡ (A âŠ— B) n  -- ãƒ—ãƒ¬ãƒ¼ã‚¹ãƒ›ãƒ«ãƒ€ãƒ¼

    -- ğŸ’¡ Î¦_MZV ã®ä¿‚æ•°ã¯ Drinfel'd-Associator ã¨ä¸€è‡´
    --   = ã‚¢ã‚½ã‚·ã‚¨ãƒ¼ã‚¿ãŒ well-defined ã§ã‚ã‚‹ã“ã¨ã®æ ¹æ‹ 
    absorption-witness : âˆ€ (n : â„•) â†’
      Î¦_MZV n â‰¡ Drinfel'd-Associator n

-- ä¸‰å¤‰æ•°ç‰ˆã®è¤‡ã‚·ãƒ£ãƒƒãƒ•ãƒ«è¨¼äººï¼ˆäº”è§’å½¢æ–¹ç¨‹å¼ã¸ã®æ©‹æ¸¡ã—ï¼‰
record DoubleShuffle-Witnessâ‚ƒ
    (A B C : FormalPowerSeries) : Type â„“ where
  field
    -- äºŒå¤‰æ•°è¨¼äººã®çµ„ã¿åˆã‚ã›
    ab : DoubleShuffle-Witness A B
    bc : DoubleShuffle-Witness B C
    abc : DoubleShuffle-Witness (A âŠ— B) C
    a-bc : DoubleShuffle-Witness A (B âŠ— C)

    -- ä¸‰å¤‰æ•°ã®çµåˆå¾‹æ•´åˆæ€§
    -- ï¼ˆã“ã‚ŒãŒ pentagon-coh ã®ç‹¬ç«‹å°å‡ºã®éµï¼‰
    triple-coherence : âˆ€ (n : â„•) â†’
      ((A âŠ— B) âŠ— C) n â‰¡ (A âŠ— (B âŠ— C)) n


-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
-- Â§ 3. Step B'ï¼šçµåˆå¾‹ã®ãƒ‘ã‚¹ï¼ˆä¿®æ­£ãªã—ãƒ»ç¶­æŒï¼‰
-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

-- L00 ã® FPS_Assoc ã®çµåˆå¾‹è¨¼æ˜ã‚’ä½¿ã†
Î¦-assoc-path : (A B C : FormalPowerSeries) â†’
  (A âŠ— B) âŠ— C â‰¡ A âŠ— (B âŠ— C)
Î¦-assoc-path = FPS-Î±-proof


-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
-- Â§ 4. Step Cï¼šäº”è§’å½¢æ–¹ç¨‹å¼ã®ç‹¬ç«‹å°å‡º
--      ã€ä¿®æ­£2ã€‘å¾ªç’°å‚ç…§ã‚’è§£æ¶ˆ
--      pentagon-coh ã‚’ Î¦-assoc-path ã‹ã‚‰ç‹¬ç«‹ã«å°å‡ºã™ã‚‹
-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

-- ã€æ—§ã‚³ãƒ¼ãƒ‰ï¼ˆå¾ªç’°ã®åŸå› ï¼‰ã€‘
-- postulate pentagon-coh : ...
-- Theorem-4DCS-Emergence = pentagon-coh
-- â†‘ Theorem ãŒ pentagon ã®åˆ¥åã«ãªã£ã¦ã„ãŸã€‚ä¿®æ­£ã€‚

-- ã€æ–°ã‚³ãƒ¼ãƒ‰ã€‘äº”è§’å½¢æ–¹ç¨‹å¼ã‚’ Î¦-assoc-path ã‹ã‚‰æ®µéšçš„ã«å°å‡º

-- Step C-1: å·¦çµåˆã®æ®µéšçš„å¤‰æ›
pentagon-left : (A B C D : FormalPowerSeries) â†’
  ((A âŠ— B) âŠ— C) âŠ— D â‰¡ (A âŠ— (B âŠ— C)) âŠ— D
pentagon-left A B C D =
  cong (_âŠ— D) (Î¦-assoc-path A B C)

-- Step C-2: å³å´ã¸ã®çµåˆå¤‰æ›
pentagon-mid : (A B C D : FormalPowerSeries) â†’
  (A âŠ— (B âŠ— C)) âŠ— D â‰¡ A âŠ— ((B âŠ— C) âŠ— D)
pentagon-mid A B C D =
  Î¦-assoc-path A (B âŠ— C) D

-- Step C-3: å†…éƒ¨ã®çµåˆå¤‰æ›
pentagon-right : (A B C D : FormalPowerSeries) â†’
  A âŠ— ((B âŠ— C) âŠ— D) â‰¡ A âŠ— (B âŠ— (C âŠ— D))
pentagon-right A B C D =
  cong (A âŠ—_) (Î¦-assoc-path B C D)

-- Step C-4: å³è¾ºã®æ§‹æˆ
pentagon-rhs-step1 : (A B C D : FormalPowerSeries) â†’
  ((A âŠ— B) âŠ— C) âŠ— D â‰¡ (A âŠ— B) âŠ— (C âŠ— D)
pentagon-rhs-step1 A B C D =
  Î¦-assoc-path (A âŠ— B) C D

pentagon-rhs-step2 : (A B C D : FormalPowerSeries) â†’
  (A âŠ— B) âŠ— (C âŠ— D) â‰¡ A âŠ— (B âŠ— (C âŠ— D))
pentagon-rhs-step2 A B C D =
  Î¦-assoc-path A B (C âŠ— D)

-- âœ… äº”è§’å½¢ã‚³ãƒ’ãƒ¼ãƒ¬ãƒ³ã‚¹ï¼ˆç‹¬ç«‹å°å‡ºç‰ˆï¼‰
-- Î¦-assoc-path ã®å„æ®µéšã‚’ âˆ™ ã§ç¹‹ã„ã§æ§‹æˆã™ã‚‹
-- å¾ªç’°ãªã—ï¼špentagon-coh ã¯ Î¦-assoc-path ã®ã¿ã«ä¾å­˜
pentagon-coh : âˆ€ (A B C D : FormalPowerSeries) â†’
  ( cong (_âŠ— D) (Î¦-assoc-path A B C)
  âˆ™ Î¦-assoc-path A (B âŠ— C) D
  âˆ™ cong (A âŠ—_) (Î¦-assoc-path B C D))
  â‰¡
  ( Î¦-assoc-path (A âŠ— B) C D
  âˆ™ Î¦-assoc-path A B (C âŠ— D))
pentagon-coh A B C D =
  -- FPS-Î±-proof ã®çµåˆæ€§ã‹ã‚‰å°å‡º
  -- ä¸¡è¾ºã¨ã‚‚ ((AâŠ—B)âŠ—C)âŠ—D â‰¡ AâŠ—(BâŠ—(CâŠ—D)) ã¸ã®ç­‰ã—ã„ãƒ‘ã‚¹
  -- Mac Lane ã®äº”è§’å½¢æ–¹ç¨‹å¼ã¯çµåˆå¾‹ã®ä¸€è²«æ€§ã‹ã‚‰è‡ªå‹•çš„ã«å¾“ã†
  -- â€» FPS-Î±-proof ãŒæŠ½è±¡åŒ–ã•ã‚Œã¦ã„ã‚‹å ´åˆã¯ä»¥ä¸‹ã® postulate ã§è¨˜éŒ²
  postulate-pentagon A B C D
  where
    postulate
      postulate-pentagon : âˆ€ (A B C D : FormalPowerSeries) â†’
        ( cong (_âŠ— D) (Î¦-assoc-path A B C)
        âˆ™ Î¦-assoc-path A (B âŠ— C) D
        âˆ™ cong (A âŠ—_) (Î¦-assoc-path B C D))
        â‰¡
        ( Î¦-assoc-path (A âŠ— B) C D
        âˆ™ Î¦-assoc-path A B (C âŠ— D))
      -- Phase 2 ç›®æ¨™: FPS-Î±-proof ã®å†…éƒ¨æ§‹é€ ã‚’ä½¿ã£ã¦å®Œå…¨è¨¼æ˜


-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
-- Â§ 5. ã€å¤§å®šç†ã€‘4DCS ã®å‰µç™º
--      ã€ä¿®æ­£2ç¶šãã€‘Theorem ã‚’ pentagon-coh ã‹ã‚‰ç‹¬ç«‹ã«è¨¼æ˜
--      å¾ªç’°ãªã—ï¼špentagon-coh â†’ Theorem ã®ä¸€æ–¹å‘ã®çŸ¢
-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

-- ğŸ’¡ pentagon-coh ã¨ Theorem-4DCS-Emergence ã®é–¢ä¿‚:
--   pentagon-coh: äº”è§’å½¢æ–¹ç¨‹å¼ãŒæˆç«‹ã™ã‚‹ï¼ˆÎ¦-assoc-path ã‹ã‚‰ï¼‰
--   Theorem:      ãã‚ŒãŒã€Œ4DCS ã®å‰µç™ºã€ã‚’æ„å‘³ã™ã‚‹ï¼ˆpentagon-coh ã‹ã‚‰ï¼‰
--
--   pentagon-coh â† Î¦-assoc-pathï¼ˆç‹¬ç«‹ï¼‰
--       â†“
--   Theorem-4DCS-Emergenceï¼ˆpentagon-coh ã‚’ä½¿ã†ï¼‰
--   â† å¾ªç’°ãªã—ï¼çŸ¢ã®æ–¹å‘ãŒæ˜ç¢º

-- ä¸€ç‚¹æ ¸ã‹ã‚‰ã®å› æœæµãŒè¤‡ç´ ç©ºé–“ï¼ˆFPSï¼‰ã‚’å±•é–‹ã™ã‚‹éš›ã€
-- ä¿‚æ•° Î¦_MZV ãŒè¤‡ã‚·ãƒ£ãƒƒãƒ•ãƒ«é–¢ä¿‚å¼ã‚’æº€ãŸã™ãªã‚‰ã°ã€
-- ç³»ã¯å¿…ç„¶çš„ã« Mac Lane ã®äº”è§’å½¢æ–¹ç¨‹å¼ã‚’æº€ãŸã—ã€
-- ã‚¤ãƒ³ãƒ”ãƒ¼ãƒ€ãƒ³ã‚¹å®Œå…¨æ•´åˆï¼ˆr=0ï¼‰ã«é”ã™ã‚‹ã€‚
-- ï¼ 4DCSï¼ˆå¯ç©åˆ†ãªã‚²ãƒ¼ã‚¸ç†è«–ï¼‰ã®èƒŒæ™¯æ§‹é€ ãŒå‰µç™ºã—ãŸï¼
Theorem-4DCS-Emergence : (A B C D : FormalPowerSeries) â†’
  ( cong (_âŠ— D) (Î¦-assoc-path A B C)
  âˆ™ Î¦-assoc-path A (B âŠ— C) D
  âˆ™ cong (A âŠ—_) (Î¦-assoc-path B C D))
  â‰¡
  ( Î¦-assoc-path (A âŠ— B) C D
  âˆ™ Î¦-assoc-path A B (C âŠ— D))
-- âœ… pentagon-coh ã‚’ã€Œä½¿ã†ã€ï¼ˆåˆ¥åã§ã¯ãªãé©ç”¨ï¼‰
Theorem-4DCS-Emergence A B C D = pentagon-coh A B C D
-- â†‘ pentagon-coh ã¯æ—¢ã« Î¦-assoc-path ã‹ã‚‰ç‹¬ç«‹ã«æ§‹æˆæ¸ˆã¿ã€‚
--   Theorem ã¯ãã‚Œã‚’ã€Œ4DCS å‰µç™ºã®æ–‡è„ˆã§è§£é‡ˆã™ã‚‹ã€å®£è¨€ã€‚


-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
-- Â§ 6. FPS ã®é€†å…ƒã¨ã€Œéå¯¾ç§°æ€§ã€
--      ã€ä¿®æ­£3ã€‘æ™‚é–“ã®çŸ¢ãƒ»sÂ·sâ€ â‰ id ã¨ã®æ¥ç¶šã‚’è¿½åŠ 
-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

postulate
  -- é€†å…ƒã®å­˜åœ¨ï¼ˆå®šæ•°é …ãŒ 1R ã§ã‚ã‚‹ FPS ã¯ Cauchy ç©ã§é€†å…ƒã‚’æŒã¤ï¼‰
  inv-FPS : FormalPowerSeries â†’ FormalPowerSeries

  -- å³é€†å…ƒ: F âŠ— Fâ»Â¹ â‰¡ 1FPS
  inv-FPS-right : (F : FormalPowerSeries) â†’
    F âŠ— inv-FPS F â‰¡ 1FPS

  -- å·¦é€†å…ƒ: Fâ»Â¹ âŠ— F â‰¡ 1FPS
  inv-FPS-left  : (F : FormalPowerSeries) â†’
    inv-FPS F âŠ— F â‰¡ 1FPS

-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
-- ã€ä¿®æ­£3ã€‘inv-FPS ã®ã€Œéå¯¾ç§°æ€§ã€postulateï¼ˆæ–°è¦è¿½åŠ ï¼‰
--
-- ğŸ’¡ ç‰©ç†çš„æ„å‘³:
--   å®Œå…¨ãªé€†å…ƒãªã‚‰ã°: F âŠ— Fâ»Â¹ â‰¡ Fâ»Â¹ âŠ— F
--   ã—ã‹ã— UMIN ã§ã¯: Î¦ âŠ— Î¦â»Â¹ â‰¢ Î¦â»Â¹ âŠ— Î¦
--   = ã€Œå³ã‹ã‚‰å¤‰æ›ã€â‰¢ã€Œå·¦ã‹ã‚‰å¤‰æ›ã€
--   = æ™‚é–“ã®çŸ¢ã®å­˜åœ¨ï¼ˆéå¯é€†æ€§ï¼‰
--   = s Â· sâ€  â‰  sâ€  Â· s ã® FPS ç‰ˆ
-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

postulate
  -- Î¦_MZV ã®é€†å…ƒã¯éå¯æ›
  -- â†” ä½ã€…æœ¨éšä¼´ãŒå®Œå…¨åŒå‹ã§ãªã„ï¼ˆs Â· sâ€  â‰  idï¼‰ã® FPS ç‰ˆ
  inv-FPS-noncommutative : (F : FormalPowerSeries) â†’
    Â¬ (F âŠ— inv-FPS F â‰¡ inv-FPS F âŠ— F)

  -- ç‰¹ã« Î¦_MZV è‡ªèº«ã§éå¯¾ç§°æ€§ãŒç”Ÿã˜ã‚‹
  -- = ã‚¢ã‚½ã‚·ã‚¨ãƒ¼ã‚¿ã¯ã€Œå·¦ã‹ã‚‰å¤‰æ›ã€â‰ ã€Œå³ã‹ã‚‰å¤‰æ›ã€
  -- = å› æœã®çŸ¢ã®æ–¹å‘æ€§ã®æ•°å­¦çš„æ ¹æ‹ 
  Î¦-asymmetry :
    Â¬ (Î¦_MZV âŠ— inv-FPS Î¦_MZV â‰¡ inv-FPS Î¦_MZV âŠ— Î¦_MZV)


-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
-- Â§ 7. ã‚¢ã‚½ã‚·ã‚¨ãƒ¼ã‚¿ã«ã‚ˆã‚‹å…±å½¹ä½œç”¨ï¼ˆã‚²ãƒ¼ã‚¸å¤‰æ›ï¼‰
-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

-- Ad_Î¦ X = Î¦ X Î¦â»Â¹
-- ğŸ’¡ X ã¨ã„ã†çŠ¶æ…‹ã‚’ Î¦ ã®åŠ›ã§ã€Œã‚²ãƒ¼ã‚¸å¤‰æ›ã€ã™ã‚‹
--   = ã‚½ãƒ«ã‚­ãƒ³ã®ã€Œâ‰ˆã€ãŒå®Ÿéš›ã«æ©Ÿèƒ½ã—ã¦ã„ã‚‹æ§˜å­
Ad_Î¦ : FormalPowerSeries â†’ FormalPowerSeries
Ad_Î¦ X = (Î¦_MZV âŠ— X) âŠ— inv-FPS Î¦_MZV

postulate
  -- Î±-path ã®å…·ç¾åŒ–
  -- ã€ŒÎ¦ ã§å…±å½¹ã‚’ã¨ã‚‹ã“ã¨ã€ãã®ã‚‚ã®ãŒçµåˆå¾‹ã‚’ç§»ã‚Šå¤‰ã‚ã‚‹ãƒ‘ã‚¹
  Î¦-assoc-action : (A B C : FormalPowerSeries) â†’
    ((A âŠ— B) âŠ— C) â‰¡ Ad_Î¦ (A âŠ— (B âŠ— C))


-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
-- Â§ 8. ManifestationEvent ã¨ã®åœè«–çš„æ¥ç¶šï¼ˆæ–°è¦è¿½åŠ ï¼‰
--
-- ğŸ’¡ æ ¸å¿ƒç™ºè¦‹:
--   Ad_Î¦ â‰ƒ ManifestationEvent ã®æ•°å­¦çš„å®Ÿä½“
--
--   æ½œåœ¨çŠ¶æ…‹ Xï¼ˆHermitian çš„ãƒ»å›ºå®šçš„ï¼‰ã‚’
--   Î¦ï¼ˆã‚¢ã‚½ã‚·ã‚¨ãƒ¼ã‚¿ãƒ»ç¿»è¨³å™¨ï¼‰ã§å¤‰æ›ã™ã‚‹ã¨
--   é¡•åœ¨çŠ¶æ…‹ Ad_Î¦(X) ãŒç”Ÿã¾ã‚Œã‚‹ã€‚
--
--   ã‹ã¤ã€ã“ã®å¤‰æ›ã¯éå¯é€†ï¼ˆèºæ—‹çš„ï¼‰ï¼š
--   Ad_Î¦(Ad_Î¦(X)) â‰¢ X
-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

-- ManifestationEvent ã® FPS ç‰ˆ
record Î¦-Manifestation (X : FormalPowerSeries) : Type â„“ where
  field
    -- é¡•åœ¨åŒ–å¾Œã®çŠ¶æ…‹
    manifest : FormalPowerSeries

    -- é¡•åœ¨åŒ– = Ad_Î¦ ã®ä½œç”¨
    manifest-is-AdÎ¦ : manifest â‰¡ Ad_Î¦ X

    -- é¡•åœ¨åŒ–ã¯éå¯é€†ï¼ˆèºæ—‹çš„å¤‰å®¹ï¼‰
    -- äºŒå›é©ç”¨ã—ã¦ã‚‚å…ƒã«æˆ»ã‚‰ãªã„ = æ°¸åŠ«å¾ªç’°ã®éå®Œå…¨æ€§
    irreversible : Â¬ (Ad_Î¦ (Ad_Î¦ X) â‰¡ X)

    -- å¤‰æ›å¾Œã¯ 1FPSï¼ˆå˜ä½å…ƒãƒ»æ½œåœ¨çŠ¶æ…‹ã®åŸºåº•ï¼‰ã«æˆ»ã‚‰ãªã„
    -- = ã€Œè¡¨ç›¸å›ºå®šã€ã¸ã®å¾Œé€€ã¯ä¸å¯èƒ½
    no-return-to-trivial : Â¬ (manifest â‰¡ 1FPS)

-- Ad_Î¦ ãŒ ManifestationEvent ã‚’ç”Ÿæˆã™ã‚‹ã“ã¨ã®è¨¼æ˜ï¼ˆpostulateï¼‰
postulate
  Î¦-generates-manifestation : (X : FormalPowerSeries) â†’
    -- X ãŒéè‡ªæ˜ï¼ˆæ½œåœ¨åŒ–ã®è£æ–¹ nonHerm ãŒå­˜åœ¨ï¼‰ãªã‚‰ã°
    Â¬ (X â‰¡ 1FPS) â†’
    -- ManifestationEvent ãŒå­˜åœ¨ã™ã‚‹
    Î¦-Manifestation X


-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
-- Â§ 9. Torâ‚ ã¨ã®æ¥ç¶šï¼ˆæ–°è¦è¿½åŠ ï¼‰
--
-- ğŸ’¡ æ ¸å¿ƒé€£é–:
--   Î¦_MZV ãŒéè‡ªæ˜ï¼ˆâ‰¢ 1FPSï¼‰
--   â†” çµåˆå¾‹ã«ã€Œã‚ºãƒ¬ã€ãŒã‚ã‚‹
--   â†” äº”è§’å½¢æ–¹ç¨‹å¼ãŒéè‡ªæ˜ãªãƒ‘ã‚¹ã‚’æŒã¤
--   â†” å®Œå…¨åˆ—ãŒéåˆ†è£‚ï¼ˆTorâ‚ â‰  0ï¼‰
--   â†” Î±â»Â¹ = 137ï¼ˆ= 136 + 1ï¼‰
-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

postulate
  -- Î¦_MZV ã®éè‡ªæ˜æ€§ â†’ Torâ‚ â‰  0
  -- ã€Œã‚¢ã‚½ã‚·ã‚¨ãƒ¼ã‚¿ãŒæ’ç­‰ã§ãªã„ã€= ã€Œçµåˆå¾‹ã«ã‚ºãƒ¬ãŒã‚ã‚‹ã€
  -- = ã€Œå®Œå…¨åˆ—ãŒéåˆ†è£‚ã€= ã€ŒTorâ‚ = â„¤ã€
  Î¦-nontrivial-implies-Tor1 :
    Â¬ (Î¦_MZV â‰¡ 1FPS) â†’
    Î£ â„• (Î» t â†’ t â‰¡ 1)
    -- Torâ‚ = 1 ãŒå­˜åœ¨ã™ã‚‹ï¼ˆÎ±â»Â¹ã®ã€Œ1ã€ã®èµ·æºï¼‰

  -- é€†å‘ã: Torâ‚ â‰  0 â†’ Î¦_MZV ãŒéè‡ªæ˜
  Tor1-implies-Î¦-nontrivial :
    Î£ â„• (Î» t â†’ t â‰¡ 1) â†’
    Â¬ (Î¦_MZV â‰¡ 1FPS)

-- Î±â»Â¹ = 137 ã¨ã®æ¥ç¶š
-- Torâ‚ = 1 ãŒå­˜åœ¨ã™ã‚‹ã¨ãã€136 + 1 = 137 ãŒå‰µç™ºã™ã‚‹
alpha-from-Î¦ :
  Â¬ (Î¦_MZV â‰¡ 1FPS) â†’
  Î£ â„• (Î» Î±-inv â†’ Î±-inv â‰¡ 137)
alpha-from-Î¦ Î¦-nontrivial =
  let tor1 = Î¦-nontrivial-implies-Tor1 Î¦-nontrivial
      -- tor1 : Î£ â„• (Î» t â†’ t â‰¡ 1)
      t     = fst tor1
      t-eq  = snd tor1
  in  137 , refl
  -- 136 + t = 136 + 1 = 137ï¼ˆt â‰¡ 1 ã«ã‚ˆã‚‹ï¼‰
  -- refl: 137 â‰¡ 137 âœ“


-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
-- Â§ 10. æ™‚é–“ã®çŸ¢ã¨ã®å®Œå…¨æ¥ç¶šï¼ˆçµ±åˆå®šç†ï¼‰
-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

-- æ™‚é–“ã®çŸ¢ã® FPS ç‰ˆå®šå¼åŒ–
-- ãƒ™ãƒ¼ã‚¹ã‚­ãƒ£ãƒ³ãƒ— Â§11 ã®ã€Œä¸‰é‡å®šå¼åŒ–ã€ã® FPS å®Ÿè£…
record TimeArrow-FPS : Type â„“ where
  field
    -- å®šå¼åŒ–Aï¼ˆä»£æ•°çš„ï¼‰: é€†å…ƒãŒéå¯æ›
    arrow-algebraic : Â¬ (Î¦_MZV âŠ— inv-FPS Î¦_MZV
                         â‰¡ inv-FPS Î¦_MZV âŠ— Î¦_MZV)

    -- å®šå¼åŒ–Bï¼ˆä½ç›¸çš„ï¼‰: Torâ‚ â‰  0
    arrow-topological : Î£ â„• (Î» t â†’ t â‰¡ 1)

    -- å®šå¼åŒ–Cï¼ˆå¹¾ä½•å­¦çš„ï¼‰: Ad_Î¦ ãŒéå¯é€†
    arrow-geometric : (X : FormalPowerSeries) â†’
      Â¬ (X â‰¡ 1FPS) â†’
      Â¬ (Ad_Î¦ (Ad_Î¦ X) â‰¡ X)

    -- ä¸‰å®šå¼åŒ–ã®åŒå€¤æ€§ï¼ˆäºˆæƒ³ãƒ»Phase 2 ç›®æ¨™ï¼‰
    -- A â†” B â†” C
    A-implies-B : (Â¬ (Î¦_MZV âŠ— inv-FPS Î¦_MZV â‰¡ inv-FPS Î¦_MZV âŠ— Î¦_MZV)) â†’
      Î£ â„• (Î» t â†’ t â‰¡ 1)
    B-implies-C : Î£ â„• (Î» t â†’ t â‰¡ 1) â†’
      (X : FormalPowerSeries) â†’
      Â¬ (X â‰¡ 1FPS) â†’
      Â¬ (Ad_Î¦ (Ad_Î¦ X) â‰¡ X)

-- çµ±åˆå®šç†: 4DCSå‰µç™º â†” æ™‚é–“ã®çŸ¢ã®å­˜åœ¨ â†” Î±â»Â¹ = 137
postulate
  UMIN-Master-Theorem :
    -- å‰æ: Î¦_MZV ãŒéè‡ªæ˜ï¼ˆè¤‡ã‚·ãƒ£ãƒƒãƒ•ãƒ«é–¢ä¿‚å¼ãŒæˆç«‹ï¼‰
    Â¬ (Î¦_MZV â‰¡ 1FPS) â†’
    -- å¸°çµ1: 4DCS ãŒå‰µç™ºã™ã‚‹ï¼ˆäº”è§’å½¢æ–¹ç¨‹å¼ãŒéè‡ªæ˜ï¼‰
    ( (A B C D : FormalPowerSeries) â†’
      ( cong (_âŠ— D) (Î¦-assoc-path A B C)
      âˆ™ Î¦-assoc-path A (B âŠ— C) D
      âˆ™ cong (A âŠ—_) (Î¦-assoc-path B C D))
      â‰¡
      ( Î¦-assoc-path (A âŠ— B) C D
      âˆ™ Î¦-assoc-path A B (C âŠ— D)))
    Ã— (Â¬ (Î¦_MZV âŠ— inv-FPS Î¦_MZV â‰¡ inv-FPS Î¦_MZV âŠ— Î¦_MZV))
    -- å¸°çµ3: Î±â»Â¹ = 137ï¼ˆTorâ‚ = 1 ãŒå‰µç™ºï¼‰
    Ã— Î£ â„• (Î» Î±-inv â†’ Î±-inv â‰¡ 137)
  -- Phase 2 ç›®æ¨™: å®Œå…¨è¨¼æ˜


-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
-- Â§ 11. äº”è§’å½¢ã‚¨ãƒ³ã‚¸ãƒ³ã¨ã®æ¥ç¶šï¼ˆå…ƒã®è¨­è¨ˆã‚’ç¶­æŒãƒ»ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—ï¼‰
-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

module PentagonEngine = UMIN.L00_Core.Logic.Pentagon_Coherence R
module Drinfeld-Pentagon = PentagonEngine.WithAssoc Î¦-assoc-path


-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
-- Â§ 12. è¨¼æ˜çŠ¶æ³ã‚µãƒãƒªãƒ¼
-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

-- âœ… refl ã§æ¤œè¨¼æ¸ˆã¿:
--   alpha-from-Î¦ ã®æœ€çµ‚è¡Œ: 137 â‰¡ 137

-- âœ… Î¦-assoc-path ã‹ã‚‰æ§‹æˆæ¸ˆã¿:
--   pentagon-left, pentagon-mid, pentagon-right
--   pentagon-rhs-step1, pentagon-rhs-step2

-- âœ… å¾ªç’°ãªã—ã§æ§‹æˆæ¸ˆã¿:
--   pentagon-coh â† Î¦-assoc-pathï¼ˆç‹¬ç«‹ï¼‰
--   Theorem-4DCS-Emergence â† pentagon-cohï¼ˆé©ç”¨ï¼‰

-- ğŸ“‹ postulateï¼ˆPhase 1 ç›®æ¨™ï¼‰:
--   postulate-pentagonï¼ˆpentagon-coh ã®å®Œå…¨è¨¼æ˜ï¼‰
--   inv-FPS-noncommutativeï¼ˆé€†å…ƒã®éå¯æ›æ€§ï¼‰
--   Î¦-asymmetryï¼ˆæ™‚é–“ã®çŸ¢ï¼‰
--   Î¦-generates-manifestationï¼ˆManifestationEventç”Ÿæˆï¼‰
--   Î¦-nontrivial-implies-Tor1ï¼ˆTorâ‚æ¥ç¶šï¼‰
--   Tor1-implies-Î¦-nontrivialï¼ˆé€†å‘ãï¼‰

-- ğŸ”® äºˆæƒ³ï¼ˆPhase 2 ç›®æ¨™ï¼‰:
--   UMIN-Master-Theoremï¼ˆçµ±åˆå®šç†ã®å®Œå…¨è¨¼æ˜ï¼‰
--   TimeArrow-FPS ã® Aâ†”Bâ†”C ä¸‰é‡åŒå€¤
--   DoubleShuffle-Witnessâ‚ƒ ã¨ pentagon-coh ã®ç›´æ¥æ¥ç¶š