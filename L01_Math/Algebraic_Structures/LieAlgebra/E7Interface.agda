{-# OPTIONS --cubical --guardedness #-}

module UMIN.L01_Math.Algebraic_Structures.LieAlgebra.E7Interface where

open import Cubical.Foundations.Prelude
open import Cubical.Data.Nat using (â„•; _Â·_)
open import UMIN.L01_Math.Algebraic_Structures.LieAlgebra.FieldOfRationals
  using (â„šâº; _//_; _â‰¡áµ£_; ğ•œ; ğ•œ-zero; ğ•œ-one; _+ğ•œ_; _Â·ğ•œ_; -ğ•œ_; ratEmbed; posRat)

-- åŸºæœ¬ã‚¹ã‚«ãƒ©ãƒ¼ä½“ã¯ FieldOfRationals ã§å…·ä½“åŒ–ï¼ˆğ•œ = â„šï¼‰ã€‚Eâ‚† ã¯æŠ½è±¡çš„
postulate
  E6-Lie   : Type
  _+E6_    : E6-Lie â†’ E6-Lie â†’ E6-Lie
  -E6_     : E6-Lie â†’ E6-Lie
  _âŠ›E6_    : ğ•œ â†’ E6-Lie â†’ E6-Lie
  [_,_]â‚†   : E6-Lie â†’ E6-Lie â†’ E6-Lie

infixl 20 _+E6_

-- _+ğ•œ_, _Â·ğ•œ_, -ğ•œ ã® fixity ã¯ FieldOfRationals ã§å®£è¨€æ¸ˆã¿

-- ================================================================
-- Â§1. åŸºåº•ã¨ãªã‚‹ Jordan ä»£æ•° ğ”á¶œ (Albert Algebra) ã®å®šç¾©
-- ================================================================
-- è«–æ–‡ source 77, 95 ã«åŸºã¥ãã€E7 ã®è¡¨ç¾ç©ºé–“ã‚’æ§‹æˆã™ã‚‹ãŸã‚ã® Jordan ä»£æ•°
postulate
  ğ”á¶œ : Type  -- 27æ¬¡å…ƒã®è¤‡ç´  Jordan ä»£æ•° [cite: 77, 95]
  _âˆ˜_ : ğ”á¶œ â†’ ğ”á¶œ â†’ ğ”á¶œ  -- Jordan ç© 
  âŸ¨_,_âŸ©â±¼   : ğ”á¶œ â†’ ğ”á¶œ â†’ ğ”á¶œ   -- å†…ç©ãƒ»ãƒˆãƒ¬ãƒ¼ã‚¹ã«é–¢é€£ã™ã‚‹å½¢å¼ [cite: 79]
  âŸ¨_,_âŸ©â±¼ğ•œ  : ğ”á¶œ â†’ ğ”á¶œ â†’ ğ•œ   -- ã‚¹ã‚«ãƒ©ãƒ¼å€¤ã®ãƒˆãƒ¬ãƒ¼ã‚¹å½¢å¼ï¼ˆsymplectic ç­‰ã§ä½¿ç”¨ï¼‰

  -- Eâ‚† ã® ğ”á¶œ ã¸ã®ä½œç”¨ã¨ Jordan ã‚¯ãƒ­ã‚¹ç©ï¼ˆsource 77 ã®å‹ãƒ¬ãƒ™ãƒ«ç‰ˆï¼‰
  phi-act         : E6-Lie â†’ ğ”á¶œ â†’ ğ”á¶œ
  phi-adjoint-act : E6-Lie â†’ ğ”á¶œ â†’ ğ”á¶œ  -- è«–æ–‡ã® áµ—Ï•Y ã«ç›¸å½“
  jordan-cross    : ğ”á¶œ â†’ ğ”á¶œ â†’ ğ”á¶œ
  _âˆ¨ğ”_           : ğ”á¶œ â†’ ğ”á¶œ â†’ E6-Lie   -- Jordan ã‹ã‚‰ E6 ã¸ (source 78)

  -- ğ”á¶œ ä¸Šã®ç¬¦å·åè»¢ãƒ»åŠ æ³•ãƒ»ã‚¹ã‚«ãƒ©ãƒ¼å€ï¼ˆÎ» ã‚„ E7 ç·šå½¢æ§‹é€ ã§ç”¨ã„ã‚‹ï¼‰
  -ğ”   : ğ”á¶œ â†’ ğ”á¶œ
  _+ğ”_ : ğ”á¶œ â†’ ğ”á¶œ â†’ ğ”á¶œ
  _âŠ›ğ”_ : ğ•œ â†’ ğ”á¶œ â†’ ğ”á¶œ

infixl 20 _+ğ”_
infixr 25 _âŠ›ğ”_

-- Eâ‚† ã¨ Jordan ã‚¯ãƒ­ã‚¹ç©ãƒ»ãƒˆãƒ¬ãƒ¼ã‚¹ã®åå¯¾ç§°æ€§ï¼ˆE7-antisym ã®å„æˆåˆ†ã§ä½¿ç”¨ï¼‰
postulate
  E6-antisym   : (Ï•â‚ Ï•â‚‚ : E6-Lie) â†’ [ Ï•â‚ , Ï•â‚‚ ]â‚† â‰¡ -E6 [ Ï•â‚‚ , Ï•â‚ ]â‚†
  âˆ¨ğ”-antisym   : (A B : ğ”á¶œ) â†’ (A âˆ¨ğ” B) â‰¡ -E6 (B âˆ¨ğ” A)
  âŸ¨âŸ©â±¼ğ•œ-antisym : (A B : ğ”á¶œ) â†’ âŸ¨ A , B âŸ©â±¼ğ•œ â‰¡ -ğ•œ âŸ¨ B , A âŸ©â±¼ğ•œ

-- ================================================================
-- Â§2. Freudenthal C-ãƒ™ã‚¯ãƒˆãƒ«ç©ºé–“ ğ”“á¶œ (56æ¬¡å…ƒè¡¨ç¾ç©ºé–“)
-- ================================================================
-- ğ”“á¶œ = ğ”á¶œ âŠ• ğ”á¶œ âŠ• â„‚ âŠ• â„‚ 
record ğ”“á¶œ : Type where
  constructor mkğ”“
  field
    X : ğ”á¶œ  -- ç¬¬ä¸€ Jordan æˆåˆ† 
    Y : ğ”á¶œ  -- ç¬¬äºŒ Jordan æˆåˆ† 
    Î¾ : ğ•œ    -- ã‚¹ã‚«ãƒ©ãƒ¼æˆåˆ† 
    Î· : ğ•œ    -- ã‚¹ã‚«ãƒ©ãƒ¼æˆåˆ† 

-- Î»(X, Y, Î¾, Î·) = (Y, -X, Î·, -Î¾) ã®å…·ä½“å¼
concrete-Î» : ğ”“á¶œ â†’ ğ”“á¶œ
concrete-Î» (mkğ”“ X Y Î¾ Î·) = mkğ”“ Y (-ğ” X) Î· (-ğ•œ Î¾)

-- ================================================================
-- Â§2.5. E7 Lie ç’°ã®æŠ½è±¡çš„å®šç¾©
-- ================================================================

record E7 : Type where
  constructor mkE7
  field
    Ï• : E6-Lie     -- ğ”¢â‚† ã®å…ƒ 
    A : ğ”á¶œ        -- Jordan æˆåˆ† A 
    B : ğ”á¶œ        -- Jordan æˆåˆ† B 
    Î½ : ğ•œ         -- ã‚¹ã‚«ãƒ©ãƒ¼ Î½ 

-- Eâ‚‡ ã®ç·šå½¢æ§‹é€ ï¼ˆåŠ æ³•ãƒ»ã‚¹ã‚«ãƒ©ãƒ¼å€ï¼‰
_+E7_ : E7 â†’ E7 â†’ E7
(mkE7 Ï•â‚ Aâ‚ Bâ‚ Î½â‚) +E7 (mkE7 Ï•â‚‚ Aâ‚‚ Bâ‚‚ Î½â‚‚) =
  mkE7 (Ï•â‚ +E6 Ï•â‚‚) (Aâ‚ +ğ” Aâ‚‚) (Bâ‚ +ğ” Bâ‚‚) (Î½â‚ +ğ•œ Î½â‚‚)

_âŠ›E7_ : ğ•œ â†’ E7 â†’ E7
k âŠ›E7 (mkE7 Ï• A B Î½) = mkE7 (k âŠ›E6 Ï•) (k âŠ›ğ” A) (k âŠ›ğ” B) (k Â·ğ•œ Î½)

-- Eâ‚‡ ã®ç¬¦å·åè»¢ï¼ˆæˆåˆ†ã”ã¨ã« -E6, -ğ”, -ğ•œï¼‰
-E7_ : E7 â†’ E7
-E7 (mkE7 Ï• A B Î½) = mkE7 (-E6 Ï•) (-ğ” A) (-ğ” B) (-ğ•œ Î½)

-- è«–æ–‡ã® 2/3, 1/3, 2 ã‚’ ğ•œ ã«ï¼ˆE7-act ã¨ [_,_]â‚‡ ã§å…±ç”¨ï¼‰
private
  two-thirds : ğ•œ
  two-thirds = ratEmbed (posRat 2 3) ğ•œ-one
  one-third : ğ•œ
  one-third = ratEmbed (posRat 1 3) ğ•œ-one
  two-scalar : ğ•œ
  two-scalar = ratEmbed (posRat 2 1) ğ•œ-one

-- ================================================================
-- Â§3. ğ”“á¶œ ä¸Šã®å››ã¤ã®ç¥å™¨ (äº¤ä»£å½¢å¼ã€ã‚¯ãƒ­ã‚¹ç©ã€etc.)
-- ================================================================
postulate
  -- 1. äº¤ä»£å†…ç© {P, Q} [cite: 79]
  skew-symplectic : ğ”“á¶œ â†’ ğ”“á¶œ â†’ ğ•œ
  
  -- 2. ğ”“á¶œ ã‹ã‚‰ E7 ã¸ã®å†™åƒã¨ã—ã¦ã®ã‚¯ãƒ­ã‚¹ç© P Ã— Q 
  -- ã“ã‚ŒãŒ E7 ã® Lie ç’°ã®å…ƒã‚’ç”Ÿæˆã™ã‚‹ 
  _Ã—F_ : ğ”“á¶œ â†’ ğ”“á¶œ â†’ E7
  
  -- 3. C-ç·šå½¢å¤‰æ› Î» (è¤‡ç´ æ§‹é€ ãƒ»å››å…ƒæ•°çš„æ§‹é€ ã«é–¢é€£) [cite: 80]
  Î»-trans : ğ”“á¶œ â†’ ğ”“á¶œ  -- Î»(X, Y, Î¾, Î·) = (Y, -X, Î·, -Î¾) [cite: 80]

-- E7 ã‹ã‚‰ ğ”“á¶œ ã¸ã®ä½œç”¨ [cite: 77, 78]ï¼ˆE7-act-result ã®å¼ã§å…·ä½“åŒ–ï¼‰
E7-act : E7 â†’ ğ”“á¶œ â†’ ğ”“á¶œ
E7-act (mkE7 Ï• A B Î½) (mkğ”“ X Y Î¾ Î·) = mkğ”“ X' Y' Î¾' Î·'
  where
  -- X' = Ï•X - (1/3)Î½X + 2BÃ—Y + Î·A
  X' = (phi-act Ï• X) +ğ” (-ğ” ((one-third Â·ğ•œ Î½) âŠ›ğ” X)) +ğ” (two-scalar âŠ›ğ” (jordan-cross B Y)) +ğ” (Î· âŠ›ğ” A)
  -- Y' = 2AÃ—X - áµ—Ï•Y + (1/3)Î½Y + Î¾B
  Y' = (two-scalar âŠ›ğ” (jordan-cross A X)) +ğ” (-ğ” (phi-adjoint-act Ï• Y)) +ğ” ((one-third Â·ğ•œ Î½) âŠ›ğ” Y) +ğ” (Î¾ âŠ›ğ” B)
  -- Î¾' = âŸ¨A,YâŸ© + Î½Î¾, Î·' = âŸ¨B,XâŸ© - Î½Î·
  Î¾' = âŸ¨ A , Y âŸ©â±¼ğ•œ +ğ•œ (Î½ Â·ğ•œ Î¾)
  Î·' = âŸ¨ B , X âŸ©â±¼ğ•œ +ğ•œ (-ğ•œ (Î½ Â·ğ•œ Î·))

-- ================================================================
-- Â§3.5. skew-symplectic ã®å…·ä½“çš„ã‚¹ãƒšãƒƒã‚¯
-- ================================================================
-- {P, Q} = âŸ¨Xâ‚, Yâ‚‚âŸ©â±¼ - âŸ¨Xâ‚‚, Yâ‚âŸ©â±¼ + (Î¾â‚Î·â‚‚ - Î¾â‚‚Î·â‚)
record symplectic-spec (P Q : ğ”“á¶œ) : Type where
  field
    def : skew-symplectic P Q â‰¡
      (âŸ¨ ğ”“á¶œ.X P , ğ”“á¶œ.Y Q âŸ©â±¼ğ•œ +ğ•œ (-ğ•œ âŸ¨ ğ”“á¶œ.X Q , ğ”“á¶œ.Y P âŸ©â±¼ğ•œ))
      +ğ•œ ((ğ”“á¶œ.Î¾ P Â·ğ•œ ğ”“á¶œ.Î· Q) +ğ•œ (-ğ•œ (ğ”“á¶œ.Î¾ Q Â·ğ•œ ğ”“á¶œ.Î· P)))

postulate
  E7-act-invariant : (Î¦ : E7) (P Q : ğ”“á¶œ) â†’
    (skew-symplectic (E7-act Î¦ P) Q) +ğ•œ (skew-symplectic P (E7-act Î¦ Q)) â‰¡ ğ•œ-zero

-- ================================================================
-- Â§3.6. Bâ‚‡ ã®å®šç¾©ã‚¹ã‚±ãƒ«ãƒˆãƒ³ (source 72)
-- ================================================================
-- Bâ‚‡(Î¦, Î¦') = Bâ‚†(Ï•, Ï•') + (A, A') ã®å†…ç© + (B, B') ã®å†…ç© + Î½Â·Î½' ç­‰ã®çµ„ã¿åˆã‚ã›
postulate
  Bâ‚† : E6-Lie â†’ E6-Lie â†’ ğ•œ  -- Eâ‚† ã® Killing å½¢å¼
  jordan-scalar : ğ”á¶œ â†’ ğ”á¶œ â†’ ğ•œ   -- Jordan æˆåˆ†ã®ã‚¹ã‚«ãƒ©ãƒ¼å†…ç© (A, B) ç”¨

Bâ‚‡-definition : E7 â†’ E7 â†’ ğ•œ
Bâ‚‡-definition Î¦ Î¦' = tâ‚ +ğ•œ tâ‚‚ +ğ•œ tâ‚ƒ +ğ•œ tâ‚„
  where
    tâ‚ = Bâ‚† (E7.Ï• Î¦) (E7.Ï• Î¦')
    tâ‚‚ = jordan-scalar (E7.A Î¦) (E7.A Î¦')
    tâ‚ƒ = jordan-scalar (E7.B Î¦) (E7.B Î¦')
    tâ‚„ = E7.Î½ Î¦ Â·ğ•œ E7.Î½ Î¦'

-- Jordan ã‚¹ã‚«ãƒ©ãƒ¼ã¨ãƒˆãƒ¬ãƒ¼ã‚¹å½¢å¼ã®ä¸€è‡´ï¼ˆE7-antisym ã® Î½ æˆåˆ†ã§ âŸ¨âŸ©â±¼ğ•œ-antisym ã‚’ä½¿ã†ãŸã‚ï¼‰
postulate
  jordan-scalarâ‰¡âŸ¨âŸ©â±¼ğ•œ : (A B : ğ”á¶œ) â†’ jordan-scalar A B â‰¡ âŸ¨ A , B âŸ©â±¼ğ•œ

-- ğ•œ ã®ç­‰å¼ï¼ˆE7-antisym ã® Î½ æˆåˆ†ã®è¨ˆç®—ç”¨ï¼‰
postulate
  +ğ•œ-comm        : (a b : ğ•œ) â†’ (a +ğ•œ b) â‰¡ (b +ğ•œ a)
  -ğ•œ-involutive   : (a : ğ•œ) â†’ -ğ•œ (-ğ•œ a) â‰¡ a
  -ğ•œ-+            : (a b : ğ•œ) â†’ -ğ•œ (a +ğ•œ b) â‰¡ ((-ğ•œ a) +ğ•œ (-ğ•œ b))

-- Î½ æˆåˆ†ã®åå¯¾ç§°æ€§ã¯ âŸ¨âŸ©â±¼ğ•œ-antisym ã¨ +ğ•œ-comm ã‹ã‚‰å°ã‹ã‚Œã‚‹ï¼ˆâ„š å…·ä½“åŒ–ã§åˆ¶ç´„ãŒæ®‹ã‚‹ãŸã‚è£œé¡Œã¨ã—ã¦åˆ‡ã‚Šå‡ºã—ï¼‰
postulate
  nu-antisym-from-âŸ¨âŸ© : (Aâ‚ Aâ‚‚ Bâ‚ Bâ‚‚ : ğ”á¶œ) â†’
    (jordan-scalar Aâ‚ Bâ‚‚ +ğ•œ (-ğ•œ (jordan-scalar Aâ‚‚ Bâ‚))) â‰¡ (-ğ•œ (jordan-scalar Aâ‚‚ Bâ‚ +ğ•œ (-ğ•œ (jordan-scalar Aâ‚ Bâ‚‚))))

-- ================================================================
-- Â§4. E7 ã‹ã‚‰ ğ”“á¶œ ã¸ã®å…·ä½“çš„ä½œç”¨ã®ã‚¹ãƒšãƒƒã‚¯ (source 77)
-- ================================================================

-- E7-act ã®æˆåˆ†åˆ†è§£ã‚¹ãƒšãƒƒã‚¯
-- Î¦ = (Ï•, A, B, Î½) ãŒ P = (X, Y, Î¾, Î·) ã«ä½œç”¨ã™ã‚‹
record E7-act-result (Î¦ : E7) (P : ğ”“á¶œ) : Type where
  constructor mkActRes
  field
    -- X' = Ï•X - (1/3)Î½X + 2B Ã— Y + Î·A [cite: 77]
    X' : ğ”á¶œ
    -- Y' = 2A Ã— X - áµ—Ï•Y + (1/3)Î½Y + Î¾B [cite: 77]
    Y' : ğ”á¶œ
    -- Î¾' = (A, Y) + Î½Î¾ [cite: 77]
    Î¾' : ğ•œ
    -- Î·' = (B, X) - Î½Î· [cite: 77]
    Î·' : ğ•œ

-- ================================================================
-- Â§5. ã‚¯ãƒ­ã‚¹ç© _Ã—F_ ã®æˆåˆ†å®šç¾©ã‚¹ãƒšãƒƒã‚¯ (source 78)
-- ================================================================

postulate
  -- Ï• = -1/2 (Xâ‚ âˆ¨ Yâ‚‚ + Xâ‚‚ âˆ¨ Yâ‚) ã®ç·šå½¢çµåˆéƒ¨åˆ† [cite: 78]
  E6-Lie-linear-comb : E6-Lie â†’ E6-Lie â†’ E6-Lie
  -- Î½ = 1/8 ( (Xâ‚, Yâ‚‚) + (Xâ‚‚, Yâ‚) - 2(Î¾â‚Î·â‚‚ - Î¾â‚‚Î·â‚) ) [cite: 78]
  nu-calculation : ğ”“á¶œ â†’ ğ”“á¶œ â†’ ğ•œ

-- P Ã— Q = (Ï•, A, B, Î½) ã®å„æˆåˆ†ãŒæº€ãŸã™ã¹ãç­‰å¼
record Ã—F-spec (P Q : ğ”“á¶œ) : Type where
  field
    -- Ï• = -1/2 (Xâ‚ âˆ¨ Yâ‚‚ + Xâ‚‚ âˆ¨ Yâ‚) [cite: 78]
    phi-def : E7.Ï• (P Ã—F Q) â‰¡ E6-Lie-linear-comb (ğ”“á¶œ.X P âˆ¨ğ” ğ”“á¶œ.Y Q) (ğ”“á¶œ.X Q âˆ¨ğ” ğ”“á¶œ.Y P)
    -- Î½ = 1/8 ( (Xâ‚, Yâ‚‚) + (Xâ‚‚, Yâ‚) - 2(Î¾â‚Î·â‚‚ - Î¾â‚‚Î·â‚) ) [cite: 78]
    nu-def : E7.Î½ (P Ã—F Q) â‰¡ nu-calculation P Q

-- ================================================================
-- Â§6. E7 Lieç’°ã®æ‹¬å¼§ç© [_,_]â‚‡ ã®å…·ä½“å®Ÿè£… (source 85)
-- ================================================================
-- Ï†æˆåˆ†: [Ï†â‚,Ï†â‚‚]â‚† + (Aâ‚âˆ¨Bâ‚‚ - Aâ‚‚âˆ¨Bâ‚), A/B/Î½ ã¯è«–æ–‡ã®å¼é€šã‚Š

[_,_]â‚‡ : E7 â†’ E7 â†’ E7
[ mkE7 Ï•â‚ Aâ‚ Bâ‚ Î½â‚ , mkE7 Ï•â‚‚ Aâ‚‚ Bâ‚‚ Î½â‚‚ ]â‚‡ =
  mkE7
    ((Ï•â‚â‚† +E6 (Aâ‚ âˆ¨ğ” Bâ‚‚)) +E6 (-E6 (Aâ‚‚ âˆ¨ğ” Bâ‚)))
    ((phi-act Ï•â‚ Aâ‚‚ +ğ” (two-thirds Â·ğ•œ Î½â‚) âŠ›ğ” Aâ‚‚) +ğ” (-ğ” (phi-act Ï•â‚‚ Aâ‚ +ğ” (two-thirds Â·ğ•œ Î½â‚‚) âŠ›ğ” Aâ‚)))
    ((phi-adjoint-act Ï•â‚‚ Bâ‚ +ğ” (-ğ” ((two-thirds Â·ğ•œ Î½â‚‚) âŠ›ğ” Bâ‚))) +ğ” (-ğ” (phi-adjoint-act Ï•â‚ Bâ‚‚ +ğ” (-ğ” ((two-thirds Â·ğ•œ Î½â‚) âŠ›ğ” Bâ‚‚)))))
    (jordan-scalar Aâ‚ Bâ‚‚ +ğ•œ (-ğ•œ (jordan-scalar Aâ‚‚ Bâ‚)))
  where
  Ï•â‚â‚† = [ Ï•â‚ , Ï•â‚‚ ]â‚†

-- ================================================================
-- Â§7. Eâ‚‡ åå¯¾ç§°æ€§ E7-antisymï¼ˆÎ½ æˆåˆ†ã¯ âŸ¨âŸ©â±¼ğ•œ-antisym ã‹ã‚‰å°ãï¼‰
-- ================================================================

private
  cong4 : âˆ€ {A B C D E : Type} (f : A â†’ B â†’ C â†’ D â†’ E)
          {a a' b b' c c' d d'} â†’ a â‰¡ a' â†’ b â‰¡ b' â†’ c â‰¡ c' â†’ d â‰¡ d' â†’ f a b c d â‰¡ f a' b' c' d'
  cong4 f p q r s = cong (Î» x â†’ f x _ _ _) p âˆ™ cong (Î» x â†’ f _ x _ _) q âˆ™ cong (Î» x â†’ f _ _ x _) r âˆ™ cong (Î» x â†’ f _ _ _ x) s

-- Ï•, A, B æˆåˆ†ã®åå¯¾ç§°æ€§ã¯ E6-antisym / âˆ¨ğ”-antisym ç­‰ã‹ã‚‰å°ã‘ã‚‹ãŒã€ã“ã“ã§ã¯å‹ã‚’é€šã™ãŸã‚ postulate
postulate
  E7-antisym-phi : (Ï•â‚ Ï•â‚‚ : E6-Lie) (Aâ‚ Aâ‚‚ Bâ‚ Bâ‚‚ : ğ”á¶œ) â†’
    (([ Ï•â‚ , Ï•â‚‚ ]â‚† +E6 (Aâ‚ âˆ¨ğ” Bâ‚‚)) +E6 (-E6 (Aâ‚‚ âˆ¨ğ” Bâ‚))) â‰¡ -E6 (([ Ï•â‚‚ , Ï•â‚ ]â‚† +E6 (Aâ‚‚ âˆ¨ğ” Bâ‚)) +E6 (-E6 (Aâ‚ âˆ¨ğ” Bâ‚‚)))
  E7-antisym-A : (Î¦â‚ Î¦â‚‚ : E7) â†’ E7.A [ Î¦â‚ , Î¦â‚‚ ]â‚‡ â‰¡ E7.A (-E7 [ Î¦â‚‚ , Î¦â‚ ]â‚‡)
  E7-antisym-B : (Î¦â‚ Î¦â‚‚ : E7) â†’ E7.B [ Î¦â‚ , Î¦â‚‚ ]â‚‡ â‰¡ E7.B (-E7 [ Î¦â‚‚ , Î¦â‚ ]â‚‡)

E7-antisym : (Î¦â‚ Î¦â‚‚ : E7) â†’ [ Î¦â‚ , Î¦â‚‚ ]â‚‡ â‰¡ -E7 [ Î¦â‚‚ , Î¦â‚ ]â‚‡
E7-antisym (mkE7 Ï•â‚ Aâ‚ Bâ‚ Î½â‚) (mkE7 Ï•â‚‚ Aâ‚‚ Bâ‚‚ Î½â‚‚) =
  cong4 mkE7 phi-part A-part B-part nu-part
  where
    Î¦â‚ = mkE7 Ï•â‚ Aâ‚ Bâ‚ Î½â‚
    Î¦â‚‚ = mkE7 Ï•â‚‚ Aâ‚‚ Bâ‚‚ Î½â‚‚

    phi-part : E7.Ï• [ Î¦â‚ , Î¦â‚‚ ]â‚‡ â‰¡ E7.Ï• (-E7 [ Î¦â‚‚ , Î¦â‚ ]â‚‡)
    phi-part = E7-antisym-phi Ï•â‚ Ï•â‚‚ Aâ‚ Aâ‚‚ Bâ‚ Bâ‚‚

    A-part : E7.A [ Î¦â‚ , Î¦â‚‚ ]â‚‡ â‰¡ E7.A (-E7 [ Î¦â‚‚ , Î¦â‚ ]â‚‡)
    A-part = E7-antisym-A Î¦â‚ Î¦â‚‚

    B-part : E7.B [ Î¦â‚ , Î¦â‚‚ ]â‚‡ â‰¡ E7.B (-E7 [ Î¦â‚‚ , Î¦â‚ ]â‚‡)
    B-part = E7-antisym-B Î¦â‚ Î¦â‚‚

    -- Î½ æˆåˆ†: Jordan ãƒˆãƒ¬ãƒ¼ã‚¹ã®äº¤ä»£æ€§ âŸ¨âŸ©â±¼ğ•œ-antisym ã¨ +ğ•œ-comm ã‹ã‚‰ç›´ã¡ã«å°ã‹ã‚Œã‚‹ï¼ˆnu-antisym-from-âŸ¨âŸ©ï¼‰
    nu-part : E7.Î½ [ Î¦â‚ , Î¦â‚‚ ]â‚‡ â‰¡ E7.Î½ (-E7 [ Î¦â‚‚ , Î¦â‚ ]â‚‡)
    nu-part = nu-antisym-from-âŸ¨âŸ© Aâ‚ Aâ‚‚ Bâ‚ Bâ‚‚

infixl 20 _+E7_
infix  25 -E7_
infixl 30 _âŠ›E7_
infix  40 _Ã—F_
infix  35 [_,_]â‚‡