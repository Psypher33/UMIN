{-# OPTIONS --cubical --guardedness #-}

module UMIN.L01_Math.Algebraic_Structures.LieAlgebra.E7Interface where

open import Cubical.Foundations.Prelude
open import Cubical.Data.Nat using (â„•; _Â·_)
open import UMIN.L01_Math.Algebraic_Structures.LieAlgebra.FieldOfRationals public
  using (â„šâº; _//_; ğ•œ; ğ•œ-zero; ğ•œ-one; _+ğ•œ_; _Â·ğ•œ_; -ğ•œ_; ratEmbed; posRat)
open import UMIN.L01_Math.Algebraic_Structures.LieAlgebra.AlbertAlgebra
  as AlbertAlg using (ğ”á¶œ; mkğ”; ğ•†-zero; _Ã—ğ”_; _âˆ˜_; âŸ¨_,_âŸ©â±¼ğ•œ; _+ğ”_; _âŠ›ğ”_; -ğ”_)
open import UMIN.L01_Math.Algebraic_Structures.LieAlgebra.E6Interface
  using (E6-Lie; E6-zero; _+E6_; -E6_; _âŠ›E6_; [_,_]â‚†; phi-act; phi-adjoint-act; _âˆ¨ğ”_;
    Ï„-E6; Î»-E6; Ï„-E6-inv; Î»-E6-inv; Ï„-Î»-E6-comm; Bâ‚†-definition)

-- ================================================================
-- Â§1. å®šæ•°ã¨è¡¨ç¾ç©ºé–“ã®å®šç¾©
-- ================================================================

two-thirds : ğ•œ
two-thirds = ratEmbed (posRat 2 3) ğ•œ-one

one-third : ğ•œ
one-third = ratEmbed (posRat 1 3) ğ•œ-one

two-scalar : ğ•œ
two-scalar = ratEmbed (posRat 2 1) ğ•œ-one

half : ğ•œ
half = ratEmbed (posRat 1 2) ğ•œ-one

-- 56æ¬¡å…ƒè¡¨ç¾ç©ºé–“ ğ”“á¶œ
record ğ”“á¶œ : Type where
  constructor mkğ”“
  field
    X : ğ”á¶œ
    Y : ğ”á¶œ
    Î¾ : ğ•œ
    Î· : ğ•œ

-- ================================================================
-- Â§2. E7 Lie ç’°ã®å®šç¾©ã¨æ¼”ç®—
-- ================================================================

record E7 : Type where
  constructor mkE7
  field
    Ï• : E6-Lie
    A : ğ”á¶œ
    B : ğ”á¶œ
    Î½ : ğ•œ

-- æ¼”ç®—å­ã®å„ªå…ˆé †ä½å®£è¨€ï¼ˆåå‰ãŒã‚¹ã‚³ãƒ¼ãƒ—ã«ã‚ã‚‹çŠ¶æ…‹ã§å®£è¨€ï¼‰
infixl 20 _+E7_
infix  25 -E7_
infixl 30 _âŠ›E7_
infix  35 [_,_]â‚‡
infix  40 _Ã—F_

-- åŠ æ³•
_+E7_ : E7 â†’ E7 â†’ E7
(mkE7 Ï•â‚ Aâ‚ Bâ‚ Î½â‚) +E7 (mkE7 Ï•â‚‚ Aâ‚‚ Bâ‚‚ Î½â‚‚) =
  mkE7 (Ï•â‚ +E6 Ï•â‚‚) (Aâ‚ +ğ” Aâ‚‚) (Bâ‚ +ğ” Bâ‚‚) (Î½â‚ +ğ•œ Î½â‚‚)

-- ç¬¦å·åè»¢
-E7_ : E7 â†’ E7
-E7 (mkE7 Ï• A B Î½) = mkE7 (-E6 Ï•) (-ğ” A) (-ğ” B) (-ğ•œ Î½)

-- ã‚¹ã‚«ãƒ©ãƒ¼å€
_âŠ›E7_ : ğ•œ â†’ E7 â†’ E7
k âŠ›E7 (mkE7 Ï• A B Î½) = mkE7 (k âŠ›E6 Ï•) (k âŠ›ğ” A) (k âŠ›ğ” B) (k Â·ğ•œ Î½)

-- E7 ã®é›¶å…ƒ
ğ”-zero : ğ”á¶œ
ğ”-zero = mkğ” ğ•œ-zero ğ•œ-zero ğ•œ-zero ğ•†-zero ğ•†-zero ğ•†-zero

E7-zero : E7
E7-zero = mkE7 E6-zero ğ”-zero ğ”-zero ğ•œ-zero

-- E7 æ‹¬å¼§ç© [_,_]â‚‡
[_,_]â‚‡ : E7 â†’ E7 â†’ E7
[ mkE7 Ï•â‚ Aâ‚ Bâ‚ Î½â‚ , mkE7 Ï•â‚‚ Aâ‚‚ Bâ‚‚ Î½â‚‚ ]â‚‡ =
  mkE7 Ï•-res A-res B-res Î½-res
  where
    Ï•â‚â‚† = [ Ï•â‚ , Ï•â‚‚ ]â‚†
    Î½â‚-coeff = two-thirds Â·ğ•œ Î½â‚
    Î½â‚‚-coeff = two-thirds Â·ğ•œ Î½â‚‚
    Ï•-res = (Ï•â‚â‚† +E6 (Aâ‚ âˆ¨ğ” Bâ‚‚)) +E6 (-E6 (Aâ‚‚ âˆ¨ğ” Bâ‚))
    A-res = (phi-act Ï•â‚ Aâ‚‚ +ğ” (Î½â‚-coeff âŠ›ğ” Aâ‚‚)) +ğ” (-ğ” (phi-act Ï•â‚‚ Aâ‚ +ğ” (Î½â‚‚-coeff âŠ›ğ” Aâ‚)))
    B-res = (phi-adjoint-act Ï•â‚‚ Bâ‚ +ğ” (-ğ” (Î½â‚‚-coeff âŠ›ğ” Bâ‚))) +ğ” (-ğ” (phi-adjoint-act Ï•â‚ Bâ‚‚ +ğ” (-ğ” (Î½â‚-coeff âŠ›ğ” Bâ‚‚))))
    Î½-res = (âŸ¨ Aâ‚ , Bâ‚‚ âŸ©â±¼ğ•œ) +ğ•œ (-ğ•œ âŸ¨ Aâ‚‚ , Bâ‚ âŸ©â±¼ğ•œ)

-- ================================================================
-- Â§2.5. E7 ã‚¯ãƒ­ã‚¹ç© _Ã—F_ ã®å…·ä½“çš„å®Ÿè£…
-- ================================================================
-- ğ”“á¶œ Ã— ğ”“á¶œ â†’ E7
-- Pâ‚ = (Xâ‚, Yâ‚, Î¾â‚, Î·â‚), Pâ‚‚ = (Xâ‚‚, Yâ‚‚, Î¾â‚‚, Î·â‚‚) ã«å¯¾ã—ã¦
-- E7(Ï•, A, B, Î½) ã‚’æ§‹æˆã™ã‚‹

_Ã—F_ : ğ”“á¶œ â†’ ğ”“á¶œ â†’ E7
(mkğ”“ Xâ‚ Yâ‚ Î¾â‚ Î·â‚) Ã—F (mkğ”“ Xâ‚‚ Yâ‚‚ Î¾â‚‚ Î·â‚‚) = mkE7 Ï•-res A-res B-res Î½-res
  where
    -- 1. E6 æˆåˆ†: Jordan å°æ¥ã®å’Œ
    -- Ï• = Xâ‚ âˆ¨ Yâ‚‚ + Xâ‚‚ âˆ¨ Yâ‚
    Ï•-res : E6-Lie
    Ï•-res = (Xâ‚ âˆ¨ğ” Yâ‚‚) +E6 (Xâ‚‚ âˆ¨ğ” Yâ‚)

    -- 2. Albert ä»£æ•°æˆåˆ† A: ã‚¹ã‚«ãƒ©ãƒ¼å€ã¨ Jordan ã‚¯ãƒ­ã‚¹ç©
    -- A = -(1/2)(Î·â‚Xâ‚‚ + Î·â‚‚Xâ‚) + Yâ‚ Ã—ğ” Yâ‚‚
    A-res : ğ”á¶œ
    A-res = (half âŠ›ğ” (-ğ” ((Î·â‚ âŠ›ğ” Xâ‚‚) +ğ” (Î·â‚‚ âŠ›ğ” Xâ‚)))) +ğ” (Yâ‚ Ã—ğ” Yâ‚‚)

    -- 3. Albert ä»£æ•°æˆåˆ† B: ã‚¹ã‚«ãƒ©ãƒ¼å€ã¨ Jordan ã‚¯ãƒ­ã‚¹ç©
    -- B = (1/2)(Î¾â‚Yâ‚‚ + Î¾â‚‚Yâ‚) - Xâ‚ Ã—ğ” Xâ‚‚
    B-res : ğ”á¶œ
    B-res = (half âŠ›ğ” ((Î¾â‚ âŠ›ğ” Yâ‚‚) +ğ” (Î¾â‚‚ âŠ›ğ” Yâ‚))) +ğ” (-ğ” (Xâ‚ Ã—ğ” Xâ‚‚))

    -- 4. ã‚¹ã‚«ãƒ©ãƒ¼æˆåˆ† Î½: å†…ç©ã¨ã‚¹ã‚«ãƒ©ãƒ¼ã®çµ„ã¿åˆã‚ã›
    -- Î½ = -(1/4)(âŸ¨Xâ‚, Yâ‚‚âŸ© + âŸ¨Xâ‚‚, Yâ‚âŸ©) + (3/4)(Î¾â‚Î·â‚‚ + Î¾â‚‚Î·â‚)
    term1 : ğ•œ
    term1 = -ğ•œ (ratEmbed (posRat 1 4) (âŸ¨ Xâ‚ , Yâ‚‚ âŸ©â±¼ğ•œ +ğ•œ âŸ¨ Xâ‚‚ , Yâ‚ âŸ©â±¼ğ•œ))
    term2 : ğ•œ
    term2 = ratEmbed (posRat 3 4) ((Î¾â‚ Â·ğ•œ Î·â‚‚) +ğ•œ (Î¾â‚‚ Â·ğ•œ Î·â‚))
    Î½-res : ğ•œ
    Î½-res = term1 +ğ•œ term2

-- ================================================================
-- Â§2.6. E7 Killing å½¢å¼ Bâ‚‡ ã®å…·ä½“çš„å®Ÿè£…
-- ================================================================
-- Bâ‚† ã¯ E6Interface ã§å®šç¾©æ¸ˆã¿

-- Bâ‚‡(Î¦â‚, Î¦â‚‚) = Bâ‚†(Ï•â‚, Ï•â‚‚) + âŸ¨Aâ‚, Bâ‚‚âŸ© + âŸ¨Aâ‚‚, Bâ‚âŸ© + (2/3)Î½â‚Î½â‚‚
-- â€» ä¿‚æ•°ã¯ UMIN ç†è«–ã®è¦æ ¼ã«åˆã‚ã›ã¦èª¿æ•´
Bâ‚‡-definition : E7 â†’ E7 â†’ ğ•œ
Bâ‚‡-definition (mkE7 Ï•â‚ Aâ‚ Bâ‚ Î½â‚) (mkE7 Ï•â‚‚ Aâ‚‚ Bâ‚‚ Î½â‚‚) =
  Bâ‚†-definition Ï•â‚ Ï•â‚‚
  +ğ•œ âŸ¨ Aâ‚ , Bâ‚‚ âŸ©â±¼ğ•œ
  +ğ•œ âŸ¨ Aâ‚‚ , Bâ‚ âŸ©â±¼ğ•œ
  +ğ•œ (two-thirds Â·ğ•œ (Î½â‚ Â·ğ•œ Î½â‚‚))

-- ================================================================
-- Â§3. ä½œç”¨ã¨ä¸å¤‰æ€§ã®ã‚¹ãƒšãƒƒã‚¯
-- ================================================================

E7-act : E7 â†’ ğ”“á¶œ â†’ ğ”“á¶œ
E7-act (mkE7 Ï• A B Î½) (mkğ”“ X Y Î¾ Î·) = mkğ”“ X' Y' Î¾' Î·'
  where
    Î½-one-third = one-third Â·ğ•œ Î½
    X' = (phi-act Ï• X) +ğ” (-ğ” (Î½-one-third âŠ›ğ” X)) +ğ” (two-scalar âŠ›ğ” (B Ã—ğ” Y)) +ğ” (Î· âŠ›ğ” A)
    Y' = (two-scalar âŠ›ğ” (A Ã—ğ” X)) +ğ” (-ğ” (phi-adjoint-act Ï• Y)) +ğ” (Î½-one-third âŠ›ğ” Y) +ğ” (Î¾ âŠ›ğ” B)
    Î¾' = âŸ¨ A , Y âŸ©â±¼ğ•œ +ğ•œ (Î½ Â·ğ•œ Î¾)
    Î·' = âŸ¨ B , X âŸ©â±¼ğ•œ +ğ•œ (-ğ•œ (Î½ Â·ğ•œ Î·))

-- ================================================================
-- Â§4. å…¬ç†ã¨è¨¼æ˜ï¼ˆæˆ»ã‚Šå€¤ã®å‹ã‚’æ˜ç¤ºã—ã¦ãƒ¡ã‚¿å¤‰æ•°ã‚’è§£æ¶ˆï¼‰
-- ================================================================

private
  cong4-mkE7 : âˆ€ {Ï• Ï•' A A' B B' Î½ Î½'} 
    â†’ Ï• â‰¡ Ï•' â†’ A â‰¡ A' â†’ B â‰¡ B' â†’ Î½ â‰¡ Î½' 
    â†’ mkE7 Ï• A B Î½ â‰¡ mkE7 Ï•' A' B' Î½'
  cong4-mkE7 p q r s i = mkE7 (p i) (q i) (r i) (s i)

postulate
  E7-antisym-phi : (Ï•â‚ Ï•â‚‚ : E6-Lie) (Aâ‚ Aâ‚‚ Bâ‚ Bâ‚‚ : ğ”á¶œ) â†’ 
    (([ Ï•â‚ , Ï•â‚‚ ]â‚† +E6 (Aâ‚ âˆ¨ğ” Bâ‚‚)) +E6 (-E6 (Aâ‚‚ âˆ¨ğ” Bâ‚))) â‰¡ 
    -E6 (([ Ï•â‚‚ , Ï•â‚ ]â‚† +E6 (Aâ‚‚ âˆ¨ğ” Bâ‚)) +E6 (-E6 (Aâ‚ âˆ¨ğ” Bâ‚‚)))

  E7-antisym-A : (Î¦â‚ Î¦â‚‚ : E7) â†’ 
    E7.A [ Î¦â‚ , Î¦â‚‚ ]â‚‡ â‰¡ E7.A (-E7 [ Î¦â‚‚ , Î¦â‚ ]â‚‡)

  E7-antisym-B : (Î¦â‚ Î¦â‚‚ : E7) â†’ 
    E7.B [ Î¦â‚ , Î¦â‚‚ ]â‚‡ â‰¡ E7.B (-E7 [ Î¦â‚‚ , Î¦â‚ ]â‚‡)

  postulate-nu-antisym : (Aâ‚ Aâ‚‚ Bâ‚ Bâ‚‚ : ğ”á¶œ) â†’ 
    (âŸ¨ Aâ‚ , Bâ‚‚ âŸ©â±¼ğ•œ +ğ•œ (-ğ•œ âŸ¨ Aâ‚‚ , Bâ‚ âŸ©â±¼ğ•œ)) â‰¡ 
    (-ğ•œ (âŸ¨ Aâ‚‚ , Bâ‚ âŸ©â±¼ğ•œ +ğ•œ (-ğ•œ âŸ¨ Aâ‚ , Bâ‚‚ âŸ©â±¼ğ•œ)))

-- ã“ã‚Œã‚’ä½¿ã£ã¦ nu-part-proof ã‚’å®šç¾©
nu-part-proof : (Aâ‚ Aâ‚‚ Bâ‚ Bâ‚‚ : ğ”á¶œ) â†’ (âŸ¨ Aâ‚ , Bâ‚‚ âŸ©â±¼ğ•œ +ğ•œ (-ğ•œ âŸ¨ Aâ‚‚ , Bâ‚ âŸ©â±¼ğ•œ)) â‰¡ (-ğ•œ (âŸ¨ Aâ‚‚ , Bâ‚ âŸ©â±¼ğ•œ +ğ•œ (-ğ•œ âŸ¨ Aâ‚ , Bâ‚‚ âŸ©â±¼ğ•œ)))
nu-part-proof = postulate-nu-antisym

E7-antisym : (Î¦â‚ Î¦â‚‚ : E7) â†’ [ Î¦â‚ , Î¦â‚‚ ]â‚‡ â‰¡ -E7 [ Î¦â‚‚ , Î¦â‚ ]â‚‡
E7-antisym (mkE7 Ï•â‚ Aâ‚ Bâ‚ Î½â‚) (mkE7 Ï•â‚‚ Aâ‚‚ Bâ‚‚ Î½â‚‚) = 
  cong4-mkE7 (E7-antisym-phi Ï•â‚ Ï•â‚‚ Aâ‚ Aâ‚‚ Bâ‚ Bâ‚‚) 
             (E7-antisym-A Î¦â‚ Î¦â‚‚) 
             (E7-antisym-B Î¦â‚ Î¦â‚‚) 
             (nu-part-proof Aâ‚ Aâ‚‚ Bâ‚ Bâ‚‚)
  where
    Î¦â‚ = mkE7 Ï•â‚ Aâ‚ Bâ‚ Î½â‚
    Î¦â‚‚ = mkE7 Ï•â‚‚ Aâ‚‚ Bâ‚‚ Î½â‚‚

-- ================================================================
--  Pá¶œ ç©ºé–“ã®å…±å½¹ã¨å¯¾åˆã®å®Ÿè£… (E8 Layer4 ã‹ã‚‰ã®ç§»è¨­)
-- ================================================================

open AlbertAlg using (Ï„-ğ”; Î»-ğ”; Ï„-ğ”-inv; Î»-ğ”-inv; Ï„-Î»-ğ”-comm)

-- ğ•œ ã®å¤‰æ› (æœ‰ç†æ•°ãªã®ã§æ’ç­‰å†™åƒ)
Ï„-ğ•œ : ğ•œ â†’ ğ•œ
Ï„-ğ•œ k = k
Î»-ğ•œ : ğ•œ â†’ ğ•œ
Î»-ğ•œ k = k

-- ğŸ’¥ æ’ƒç ´ï¼ Pá¶œ ç©ºé–“ã®å…±å½¹ã¨å¯¾åˆã®å®Œå…¨å®Ÿè£…
Ï„-P : ğ”“á¶œ â†’ ğ”“á¶œ
Ï„-P (mkğ”“ X Y Î¾ Î·) = mkğ”“ (Ï„-ğ” X) (Ï„-ğ” Y) (Ï„-ğ•œ Î¾) (Ï„-ğ•œ Î·)

Î»-P : ğ”“á¶œ â†’ ğ”“á¶œ
Î»-P (mkğ”“ X Y Î¾ Î·) = mkğ”“ (Î»-ğ” X) (Î»-ğ” Y) (Î»-ğ•œ Î¾) (Î»-ğ•œ Î·)

-- è¨¼æ˜ï¼šPá¶œ ã®å¯¾åˆæ€§ (Albertä»£æ•°ã®è¨¼æ˜ã‚’åˆ©ç”¨)
private
  cong4-mkğ”“ : âˆ€ {X X' Y Y' Î¾ Î¾' Î· Î·'}
    â†’ X â‰¡ X' â†’ Y â‰¡ Y' â†’ Î¾ â‰¡ Î¾' â†’ Î· â‰¡ Î·'
    â†’ mkğ”“ X Y Î¾ Î· â‰¡ mkğ”“ X' Y' Î¾' Î·'
  cong4-mkğ”“ p1 p2 p3 p4 i = mkğ”“ (p1 i) (p2 i) (p3 i) (p4 i)

Ï„-P-inv : (P : ğ”“á¶œ) â†’ Ï„-P (Ï„-P P) â‰¡ P
Ï„-P-inv (mkğ”“ X Y Î¾ Î·) = cong4-mkğ”“ (Ï„-ğ”-inv X) (Ï„-ğ”-inv Y) refl refl

Î»-P-inv : (P : ğ”“á¶œ) â†’ Î»-P (Î»-P P) â‰¡ P
Î»-P-inv (mkğ”“ X Y Î¾ Î·) = cong4-mkğ”“ (Î»-ğ”-inv X) (Î»-ğ”-inv Y) refl refl

Ï„-Î»-P-comm : (P : ğ”“á¶œ) â†’ Ï„-P (Î»-P P) â‰¡ Î»-P (Ï„-P P)
Ï„-Î»-P-comm (mkğ”“ X Y Î¾ Î·) = cong4-mkğ”“ (Ï„-Î»-ğ”-comm X) (Ï„-Î»-ğ”-comm Y) refl refl

-- ================================================================
--  E7 ä¸Šã®å¤‰æ›ã®ã€Œå…·ä½“çš„ãªå®Ÿè£…ã€ã¨ã€Œè¨¼æ˜ã€ (ç†è«–æ­¦è£…ç‰ˆ)
-- ================================================================

-- ğŸ’¥ æ’ƒç ´ï¼ E7 ãƒ¬ãƒ™ãƒ«ã®å¤‰æ›ã®å®Œå…¨å®Ÿè£…
-- Ï• (E6), A, B (ğ”á¶œ), Î½ (ğ•œ) ã®ãã‚Œãã‚Œã®å¤‰æ›ã‚’å‘¼ã³å‡ºã™
Ï„-E7 : E7 â†’ E7
Ï„-E7 (mkE7 Ï• A B Î½) = mkE7 (Ï„-E6 Ï•) (Ï„-ğ” A) (Ï„-ğ” B) (Ï„-ğ•œ Î½)

Î»-E7 : E7 â†’ E7
Î»-E7 (mkE7 Ï• A B Î½) = mkE7 (Î»-E6 Ï•) (Î»-ğ” A) (Î»-ğ” B) (Î»-ğ•œ Î½)

-- ğŸ’¥ æ’ƒç ´ï¼ E7 ã®å¯¾åˆã®å®Œå…¨ãªè¨¼æ˜
-- cong4-mkE7 ã‚’ä½¿ã„ã€ä¸‹ä½å±¤ã®è¨¼æ˜ï¼ˆÏ„-ğ”-inv ã‚„ reflï¼‰ã‚’è©°ã‚è¾¼ã‚€
Ï„-E7-inv : (Î¦ : E7) â†’ Ï„-E7 (Ï„-E7 Î¦) â‰¡ Î¦
Ï„-E7-inv (mkE7 Ï• A B Î½) = cong4-mkE7 (Ï„-E6-inv Ï•) (Ï„-ğ”-inv A) (Ï„-ğ”-inv B) refl

Î»-E7-inv : (Î¦ : E7) â†’ Î»-E7 (Î»-E7 Î¦) â‰¡ Î¦
Î»-E7-inv (mkE7 Ï• A B Î½) = cong4-mkE7 (Î»-E6-inv Ï•) (Î»-ğ”-inv A) (Î»-ğ”-inv B) refl

Ï„-Î»-E7-comm : (Î¦ : E7) â†’ Ï„-E7 (Î»-E7 Î¦) â‰¡ Î»-E7 (Ï„-E7 Î¦)
Ï„-Î»-E7-comm (mkE7 Ï• A B Î½) = cong4-mkE7 (Ï„-Î»-E6-comm Ï•) (Ï„-Î»-ğ”-comm A) (Ï„-Î»-ğ”-comm B) refl